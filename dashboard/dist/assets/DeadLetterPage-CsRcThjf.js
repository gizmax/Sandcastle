import{u as m,j as e,h as p,a as i,C as h,r as a,i as c,L as u,I as f}from"./index-CwcY_0GV.js";import{R as j}from"./rotate-ccw-nPwpX8M5.js";import{E as y}from"./EmptyState-BQhpdpld.js";function b({items:r,onRetry:d,onResolve:l}){const n=m();return e.jsx("div",{className:"rounded-xl border border-border bg-surface shadow-sm overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-background/50",children:[e.jsx("th",{className:"px-3 sm:px-5 py-3 text-left font-medium text-muted",children:"Step"}),e.jsx("th",{className:"px-3 sm:px-5 py-3 text-left font-medium text-muted",children:"Error"}),e.jsx("th",{className:"hidden sm:table-cell px-3 sm:px-5 py-3 text-left font-medium text-muted",children:"Attempts"}),e.jsx("th",{className:"hidden md:table-cell px-3 sm:px-5 py-3 text-left font-medium text-muted",children:"Created"}),e.jsx("th",{className:"px-3 sm:px-5 py-3 text-right font-medium text-muted",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:r.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 sm:px-5 py-3",children:e.jsx("button",{onClick:()=>n(`/runs/${t.run_id}`),className:"font-medium text-accent hover:text-accent-hover transition-colors",children:t.step_id})}),e.jsx("td",{className:"max-w-xs px-3 sm:px-5 py-3",children:e.jsx("p",{className:"truncate font-mono text-xs text-error",children:t.error||"-"})}),e.jsx("td",{className:"hidden sm:table-cell px-3 sm:px-5 py-3 text-muted",children:t.attempts}),e.jsx("td",{className:"hidden md:table-cell px-3 sm:px-5 py-3 text-muted",children:t.created_at?p(t.created_at):"-"}),e.jsx("td",{className:"px-3 sm:px-5 py-3 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsxs("button",{onClick:()=>d(t.id),className:i("flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium","text-running hover:bg-running/10 transition-colors"),children:[e.jsx(j,{className:"h-3 w-3"}),"Retry"]}),e.jsxs("button",{onClick:()=>l(t.id),className:i("flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium","text-success hover:bg-success/10 transition-colors"),children:[e.jsx(h,{className:"h-3 w-3"}),"Resolve"]})]})})]},t.id))})]})})})}function w(){const[r,d]=a.useState([]),[l,n]=a.useState(!0),t=a.useCallback(async()=>{try{const s=await c.get("/dead-letter");s.data&&d(s.data)}finally{n(!1)}},[]);a.useEffect(()=>{t()},[t]);const x=a.useCallback(async s=>{await c.post(`/dead-letter/${s}/retry`),t()},[t]),o=a.useCallback(async s=>{await c.post(`/dead-letter/${s}/resolve`),t()},[t]);return l?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(u,{size:"lg"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight text-foreground",children:"Dead Letter Queue"}),r.length===0?e.jsx(y,{icon:f,title:"No dead letters",description:"Failed steps that exceed retry limits will appear here."}):e.jsx(b,{items:r,onRetry:x,onResolve:o})]})}export{w as default};
