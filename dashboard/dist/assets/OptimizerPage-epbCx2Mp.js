import{u as y,r as o,i as m,j as e,L as _,a as d,f as u,x as p,h as C}from"./index-CwcY_0GV.js";import{E as S}from"./EmptyState-BQhpdpld.js";import{C as E}from"./chevron-up-CHQN3fbL.js";import{C as k}from"./chevron-down-D_IPnZAM.js";function f(a){return a>=.8?"text-success":a>=.5?"text-warning":"text-error"}function z(a){return a>=.8?"bg-success":a>=.5?"bg-warning":"bg-error"}const h={haiku:"bg-success/10 text-success border-success/30",sonnet:"bg-accent/10 text-accent border-accent/30",opus:"bg-purple-500/10 text-purple-400 border-purple-500/30"};function T(){const a=y(),[i,g]=o.useState([]),[n,b]=o.useState(null),[j,N]=o.useState(!0),[v,w]=o.useState(null),c=o.useCallback(async()=>{try{const[s,r]=await Promise.all([m.get("/optimizer/decisions"),m.get("/optimizer/stats")]);s.data&&g(s.data),r.data&&b(r.data)}finally{N(!1)}},[]);if(o.useEffect(()=>{c()},[c]),j)return e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(_,{size:"lg"})});const l=n?Object.entries(n.model_distribution).sort(([,s],[,r])=>r-s)[0]:null;return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight text-foreground",children:"Cost-Latency Optimizer"}),n&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 lg:grid-cols-4",children:[e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Decisions (30d)"}),e.jsx("p",{className:"mt-1 text-xl sm:text-2xl font-semibold text-foreground",children:n.total_decisions_30d})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Avg Confidence"}),e.jsxs("p",{className:d("mt-1 text-xl sm:text-2xl font-semibold",f(n.avg_confidence)),children:[(n.avg_confidence*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Top Model"}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-foreground capitalize",children:l?.[0]||"-"}),l&&e.jsxs("span",{className:"text-sm text-muted",children:[(l[1]*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Estimated Savings"}),e.jsx("p",{className:"mt-1 text-xl sm:text-2xl font-semibold text-accent",children:u(n.estimated_savings_30d_usd)})]})]}),i.length===0?e.jsx(S,{icon:p,title:"No optimizer decisions",description:"When the optimizer selects models for workflow steps, decisions will appear here."}):e.jsx("div",{className:"space-y-3",children:i.map(s=>{const r=v===s.id,x=h[s.selected_model]||h.sonnet;return e.jsxs("div",{className:"rounded-xl border border-border bg-surface shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 px-3 sm:px-5 py-3 sm:py-4 cursor-pointer hover:bg-border/10 transition-colors",onClick:()=>w(r?null:s.id),children:[e.jsx("div",{className:d("flex h-10 w-10 shrink-0 items-center justify-center rounded-lg border",x),children:e.jsx(p,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:d("rounded-full border px-2.5 py-0.5 text-xs font-semibold capitalize",x),children:s.selected_model}),e.jsx("span",{className:"text-sm font-medium text-foreground",children:s.step_id}),e.jsx("button",{onClick:t=>{t.stopPropagation(),a(`/runs/${s.run_id}`)},className:"text-xs font-medium text-accent hover:text-accent-hover transition-colors",children:"run"})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-[120px]",children:[e.jsx("div",{className:"h-1.5 w-16 rounded-full bg-border overflow-hidden",children:e.jsx("div",{className:d("h-full rounded-full transition-all",z(s.confidence)),style:{width:`${s.confidence*100}%`}})}),e.jsxs("span",{className:d("text-xs font-medium",f(s.confidence)),children:[(s.confidence*100).toFixed(0),"%"]})]}),e.jsx("p",{className:"text-xs text-muted truncate max-w-sm",children:s.reason})]})]}),s.budget_pressure!=null&&s.budget_pressure>=.7&&e.jsxs("span",{className:d("inline-flex items-center gap-1.5 rounded-full border px-2 py-0.5 text-xs font-medium",s.budget_pressure>=.9?"bg-error/15 border-error/30 text-error":"bg-warning/15 border-warning/30 text-warning"),children:[e.jsx("span",{className:d("h-1.5 w-1.5 rounded-full",s.budget_pressure>=.9?"bg-error animate-pulse":"bg-warning")}),(s.budget_pressure*100).toFixed(0),"% budget"]}),e.jsx("span",{className:"text-xs text-muted shrink-0",children:C(s.created_at)}),r?e.jsx(E,{className:"h-4 w-4 text-muted shrink-0"}):e.jsx(k,{className:"h-4 w-4 text-muted shrink-0"})]}),r&&e.jsxs("div",{className:"border-t border-border",children:[s.alternatives.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-background/50",children:[e.jsx("th",{className:"px-3 sm:px-5 py-2.5 text-left font-medium text-muted",children:"Model"}),e.jsx("th",{className:"px-3 sm:px-5 py-2.5 text-right font-medium text-muted",children:"Quality"}),e.jsx("th",{className:"px-3 sm:px-5 py-2.5 text-right font-medium text-muted",children:"Cost"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:s.alternatives.map(t=>e.jsxs("tr",{className:d(t.model===s.selected_model&&"bg-accent/5"),children:[e.jsx("td",{className:"px-3 sm:px-5 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-foreground capitalize",children:t.model}),t.model===s.selected_model&&e.jsx("span",{className:"rounded bg-accent/15 px-1.5 py-0.5 text-[10px] font-semibold text-accent",children:"SELECTED"})]})}),e.jsx("td",{className:"px-3 sm:px-5 py-3 text-right font-mono text-muted",children:t.avg_quality!=null?t.avg_quality.toFixed(3):"-"}),e.jsx("td",{className:"px-3 sm:px-5 py-3 text-right font-mono text-muted",children:t.avg_cost!=null?u(t.avg_cost):"-"})]},t.id))})]})}),s.slo&&e.jsxs("div",{className:"px-5 py-4 bg-background/30",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"SLO Configuration"}),e.jsx("pre",{className:"max-h-32 overflow-auto rounded-lg bg-surface border border-border p-3 font-mono text-xs text-muted",children:JSON.stringify(s.slo,null,2)})]})]})]},s.id)})})]})}export{T as default};
