import{u as V,r as a,i as N,j as e,L as G,S as W,a as l,y as X,X as L,t as O}from"./index-BxoS6zFR.js";import{t as T}from"./index-BtCl_quS.js";import{E as Y}from"./EmptyState-BPInumdg.js";import{A}from"./arrow-right-CQB1yzDT.js";import{P as D}from"./play-CiRW9BCK.js";import"./index-iCV9RHQg.js";const E=["bg-accent/15 text-accent","bg-running/15 text-running","bg-success/15 text-success","bg-queued/15 text-queued","bg-error/15 text-error","bg-warning/15 text-warning"];function q(c){let o=0;for(let d=0;d<c.length;d++)o=c.charCodeAt(d)+((o<<5)-o);return E[Math.abs(o)%E.length]}function se(){const c=V(),[o,d]=a.useState([]),[M,z]=a.useState(!0),[u,v]=a.useState(""),[i,f]=a.useState(null),[p,w]=a.useState(null),[r,y]=a.useState(null),[I,C]=a.useState(!1),[F,x]=a.useState(!1),[g,k]=a.useState("{}"),[h,b]=a.useState({}),[j,S]=a.useState(!1);a.useEffect(()=>{N.get("/templates").then(t=>{d(t.data||[])}).finally(()=>z(!1))},[]);const P=a.useMemo(()=>{const t=new Set;return o.forEach(s=>s.tags.forEach(n=>t.add(n))),Array.from(t).sort()},[o]),_=a.useMemo(()=>{let t=o;if(u){const s=u.toLowerCase();t=t.filter(n=>n.name.toLowerCase().includes(s)||n.description.toLowerCase().includes(s))}return i&&(t=t.filter(s=>s.tags.includes(i))),t},[o,u,i]),$=a.useCallback(async t=>{w(t),C(!0);const s=await N.get(`/templates/${t}`);s.data&&y(s.data),C(!1)},[]),R=a.useCallback(()=>{w(null),y(null)},[]),B=a.useCallback(()=>{r&&c("/workflows/builder",{state:{yaml:r.content}})},[r,c]),J=a.useCallback(()=>{if(r?.input_schema?.properties){const t={};for(const[s,n]of Object.entries(r.input_schema.properties))t[s]=n.default!=null?String(n.default):"";b(t)}else b({});k("{}"),x(!0)},[r]),U=a.useCallback(async()=>{if(!r)return;S(!0);let t={};if(r.input_schema?.properties)for(const[n,m]of Object.entries(h))m&&(t[n]=m);else try{t=JSON.parse(g)}catch{}const s=await N.post("/workflows/run",{workflow:r.content,input:t});if(S(!1),x(!1),s.error)T.error(`Run failed: ${s.error.message}`);else if(s.data){T.success("Workflow started");const n=s.data.run_id;n&&c(`/runs/${n}`)}},[r,h,g,c]);return M?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(G,{size:"lg"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight text-foreground",children:"Templates"}),e.jsxs("span",{className:"text-sm text-muted",children:[o.length," templates"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(W,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted"}),e.jsx("input",{type:"text",value:u,onChange:t=>v(t.target.value),placeholder:"Search templates...",className:l("h-9 w-full rounded-lg border border-border bg-background pl-9 pr-3 text-sm","focus:border-accent/50 focus:outline-none focus:ring-2 focus:ring-ring/30")})]}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[e.jsx("button",{onClick:()=>f(null),className:l("rounded-full px-2.5 py-1 text-xs font-medium transition-colors",i?"bg-border/40 text-muted hover:text-foreground":"bg-accent text-accent-foreground"),children:"All"}),P.map(t=>e.jsx("button",{onClick:()=>f(i===t?null:t),className:l("rounded-full px-2.5 py-1 text-xs font-medium transition-colors",i===t?"bg-accent text-accent-foreground":"bg-border/40 text-muted hover:text-foreground"),children:t},t))]})]}),_.length===0?e.jsx(Y,{icon:X,title:"No templates found",description:"Try adjusting your search or tag filter.",action:u||i?{label:"Reset filters",onClick:()=>{v(""),f(null)}}:void 0}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:_.map(t=>e.jsxs("button",{type:"button",onClick:()=>$(t.name),className:l("group rounded-xl border p-4 text-left transition-all duration-200",p===t.name?"border-accent ring-2 ring-accent/20 bg-accent/5":"border-border bg-surface hover:border-border hover:shadow-md hover:bg-surface"),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-semibold text-foreground",children:t.name.replace(/_/g," ")}),e.jsx(A,{className:"h-4 w-4 text-muted opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsx("p",{className:"text-xs text-muted leading-relaxed mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex flex-wrap gap-1.5",children:t.tags.map(s=>e.jsx("span",{className:l("rounded-full px-2 py-0.5 text-[10px] font-medium",q(s)),children:s},s))}),e.jsxs("span",{className:"text-[11px] text-muted-foreground shrink-0 ml-2",children:[t.step_count," ",t.step_count===1?"step":"steps"]})]})]},t.name))}),p&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40 bg-black/40",onClick:R}),e.jsxs("div",{className:"fixed inset-y-0 right-0 z-50 flex w-full max-w-lg flex-col border-l border-border bg-surface shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-border px-5 py-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:p.replace(/_/g," ")}),e.jsx("button",{onClick:R,className:"rounded-lg p-1 text-muted hover:text-foreground transition-colors",children:e.jsx(L,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-5",children:I?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(O,{className:"h-6 w-6 animate-spin text-muted"})}):r?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted leading-relaxed",children:r.description}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-1.5",children:[r.tags.map(t=>e.jsx("span",{className:l("rounded-full px-2.5 py-0.5 text-xs font-medium",q(t)),children:t},t)),e.jsxs("span",{className:"rounded-full bg-border/40 px-2.5 py-0.5 text-xs font-medium text-muted",children:[r.step_count," ",r.step_count===1?"step":"steps"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"mb-2 text-xs font-medium text-muted",children:"YAML Definition"}),e.jsx("pre",{className:"max-h-96 overflow-auto rounded-lg bg-background p-4 font-mono text-xs text-foreground whitespace-pre-wrap",children:r.content})]})]}):e.jsx("p",{className:"text-sm text-muted",children:"Template not found"})}),r&&e.jsxs("div",{className:"flex items-center gap-2 border-t border-border px-5 py-4",children:[e.jsxs("button",{onClick:B,className:l("flex flex-1 items-center justify-center gap-2 rounded-lg border border-border px-4 py-2","text-sm font-medium text-foreground","hover:bg-border/40 transition-colors"),children:[e.jsx(A,{className:"h-4 w-4"}),"Use in Builder"]}),e.jsxs("button",{onClick:J,className:l("flex flex-1 items-center justify-center gap-2 rounded-lg bg-accent px-4 py-2","text-sm font-medium text-accent-foreground","hover:bg-accent-hover transition-all duration-200 shadow-sm"),children:[e.jsx(D,{className:"h-4 w-4"}),"Run Now"]})]})]})]}),F&&r&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[60] bg-black/40",onClick:()=>x(!1)}),e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:e.jsxs("div",{className:"w-full max-w-md rounded-xl border border-border bg-surface p-6 shadow-xl",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-lg font-semibold text-foreground",children:["Run ",r.name.replace(/_/g," ")]}),e.jsx("button",{onClick:()=>x(!1),className:"rounded-lg p-1 text-muted hover:text-foreground",children:e.jsx(L,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"space-y-4",children:[r.input_schema?.properties?Object.entries(r.input_schema.properties).map(([t,s])=>e.jsxs("div",{children:[e.jsxs("label",{className:"mb-1 block text-xs font-medium text-muted",children:[t,r.input_schema?.required?.includes(t)&&e.jsx("span",{className:"text-error ml-0.5",children:"*"})]}),s.description&&e.jsx("p",{className:"mb-1.5 text-xs text-muted-foreground",children:s.description}),e.jsx("input",{type:"text",value:h[t]||"",onChange:n=>b(m=>({...m,[t]:n.target.value})),placeholder:s.default!=null?String(s.default):t,required:r.input_schema?.required?.includes(t),className:l("h-9 w-full rounded-lg border border-border bg-background px-3 text-sm","focus:border-accent/50 focus:outline-none focus:ring-2 focus:ring-ring/30")})]},t)):e.jsxs("div",{children:[e.jsx("label",{className:"mb-1 block text-xs font-medium text-muted",children:"Input Data (JSON)"}),e.jsx("textarea",{value:g,onChange:t=>k(t.target.value),rows:6,className:l("w-full rounded-lg border border-border bg-background px-3 py-2 font-mono text-sm","focus:border-accent/50 focus:outline-none focus:ring-2 focus:ring-ring/30")})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>x(!1),className:"rounded-lg border border-border px-4 py-2 text-sm font-medium text-muted hover:text-foreground transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:U,disabled:j,className:l("flex items-center gap-2 rounded-lg bg-accent px-4 py-2 text-sm font-medium text-accent-foreground","hover:bg-accent-hover transition-all duration-200 shadow-sm",j&&"opacity-50 cursor-not-allowed"),children:[j&&e.jsx(O,{className:"h-3.5 w-3.5 animate-spin"}),e.jsx(D,{className:"h-3.5 w-3.5"}),"Run"]})]})]})]})})]})]})}export{se as default};
