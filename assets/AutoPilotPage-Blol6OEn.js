import{c as f,r as d,i as h,j as e,L as C,f as j,F as N,a as i,h as E}from"./index-BxoS6zFR.js";import{E as D}from"./EmptyState-BPInumdg.js";import{R}from"./rocket-Dcc1osvH.js";import{R as M}from"./rotate-ccw-DE8uKj7r.js";const P=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Q=f("trending-down",P);const T=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],z=f("trending-up",T);const L=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],F=f("trophy",L),y={active:{bg:"bg-running/15 border-running/30",text:"text-running",dot:"bg-running animate-pulse",label:"Active"},completed:{bg:"bg-success/15 border-success/30",text:"text-success",dot:"bg-success",label:"Completed"},paused:{bg:"bg-warning/15 border-warning/30",text:"text-warning",dot:"bg-warning",label:"Paused"}};function V(u){const l={};for(const a of u){l[a.variant_id]||(l[a.variant_id]={scores:[],costs:[],durations:[],count:0});const n=l[a.variant_id];n.count++,a.quality_score!==null&&n.scores.push(a.quality_score),n.costs.push(a.cost_usd),n.durations.push(a.duration_seconds)}return Object.entries(l).map(([a,n])=>({id:a,count:n.count,avgQuality:n.scores.length>0?n.scores.reduce((o,c)=>o+c,0)/n.scores.length:0,avgCost:n.costs.reduce((o,c)=>o+c,0)/n.costs.length,avgDuration:n.durations.reduce((o,c)=>o+c,0)/n.durations.length}))}function O(){const[u,l]=d.useState([]),[a,n]=d.useState(null),[o,c]=d.useState(!0),[v,w]=d.useState(null),x=d.useCallback(async()=>{try{const[t,r]=await Promise.all([h.get("/autopilot/experiments"),h.get("/autopilot/stats")]);t.data&&l(t.data),r.data&&n(r.data)}finally{c(!1)}},[]);d.useEffect(()=>{x()},[x]);const _=d.useCallback(async(t,r)=>{await h.post(`/autopilot/experiments/${t}/deploy`,{variant_id:r}),x()},[x]),k=d.useCallback(async t=>{await h.post(`/autopilot/experiments/${t}/reset`),x()},[x]);return o?e.jsx("div",{className:"flex h-64 items-center justify-center",children:e.jsx(C,{size:"lg"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-semibold tracking-tight text-foreground",children:"AutoPilot"}),a&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 lg:grid-cols-4",children:[e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Active Experiments"}),e.jsx("p",{className:"mt-1 text-xl sm:text-2xl font-semibold text-foreground",children:a.active_experiments})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Total Samples"}),e.jsx("p",{className:"mt-1 text-xl sm:text-2xl font-semibold text-foreground",children:a.total_samples})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Avg Quality Improvement"}),e.jsxs("div",{className:"mt-1 flex items-center gap-1.5",children:[e.jsx(z,{className:"h-5 w-5 text-success"}),e.jsxs("p",{className:"text-xl sm:text-2xl font-semibold text-success",children:["+",(a.avg_quality_improvement*100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"rounded-xl border border-border bg-surface p-4 shadow-sm",children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground",children:"Cost Savings"}),e.jsxs("div",{className:"mt-1 flex items-center gap-1.5",children:[e.jsx(Q,{className:"h-5 w-5 text-accent"}),e.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-accent",children:j(a.total_cost_savings_usd)})]})]})]}),u.length===0?e.jsx(D,{icon:N,title:"No experiments yet",description:"Add autopilot config to any workflow step to start optimizing automatically."}):e.jsx("div",{className:"space-y-4",children:u.map(t=>{const r=y[t.status]||y.active,b=v===t.id,p=t.samples?V(t.samples):[],S=p.length>0?p.reduce((s,m)=>s.avgQuality>m.avgQuality?s:m):null;return e.jsxs("div",{className:"rounded-xl border border-border bg-surface shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-4 px-5 py-4 cursor-pointer hover:bg-border/10 transition-colors",onClick:()=>w(b?null:t.id),children:[e.jsx("div",{className:i("flex h-10 w-10 shrink-0 items-center justify-center rounded-lg border",r.bg),children:e.jsx(N,{className:i("h-5 w-5",r.text)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:t.workflow_name}),e.jsx("span",{className:"text-xs text-muted",children:"/"}),e.jsx("p",{className:"text-sm text-accent",children:t.step_id})]}),e.jsxs("div",{className:"flex items-center gap-3 mt-1",children:[e.jsxs("span",{className:"text-xs text-muted",children:["Optimize: ",e.jsx("span",{className:"font-medium text-foreground capitalize",children:t.optimize_for})]}),e.jsxs("span",{className:"text-xs text-muted",children:[t.samples?.length||0," samples"]}),t.created_at&&e.jsx("span",{className:"text-xs text-muted",children:E(t.created_at)})]})]}),t.deployed_variant_id&&e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full bg-accent/15 border border-accent/30 px-2.5 py-0.5 text-xs font-medium text-accent",children:[e.jsx(F,{className:"h-3 w-3"}),t.deployed_variant_id]}),e.jsxs("span",{className:i("inline-flex items-center gap-1.5 rounded-full border px-2 py-0.5 text-xs font-medium",r.bg,r.text),children:[e.jsx("span",{className:i("h-1.5 w-1.5 rounded-full",r.dot)}),r.label]})]}),b&&e.jsxs("div",{className:"border-t border-border",children:[p.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-border bg-background/50",children:[e.jsx("th",{className:"px-5 py-2.5 text-left font-medium text-muted",children:"Variant"}),e.jsx("th",{className:"px-5 py-2.5 text-right font-medium text-muted",children:"Samples"}),e.jsx("th",{className:"px-5 py-2.5 text-right font-medium text-muted",children:"Avg Quality"}),e.jsx("th",{className:"px-5 py-2.5 text-right font-medium text-muted",children:"Avg Cost"}),e.jsx("th",{className:"px-5 py-2.5 text-right font-medium text-muted",children:"Avg Duration"}),e.jsx("th",{className:"px-5 py-2.5 text-right font-medium text-muted",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:p.map(s=>{const m=S?.id===s.id,g=t.deployed_variant_id===s.id;return e.jsxs("tr",{className:i(m&&"bg-accent/5"),children:[e.jsx("td",{className:"px-5 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-foreground",children:s.id}),m&&!g&&e.jsx("span",{className:"rounded bg-accent/15 px-1.5 py-0.5 text-[10px] font-semibold text-accent",children:"BEST"}),g&&e.jsx("span",{className:"rounded bg-success/15 px-1.5 py-0.5 text-[10px] font-semibold text-success",children:"DEPLOYED"})]})}),e.jsx("td",{className:"px-5 py-3 text-right text-muted",children:s.count}),e.jsx("td",{className:"px-5 py-3 text-right",children:e.jsxs("span",{className:i("font-medium",s.avgQuality>=7?"text-success":s.avgQuality>=5?"text-warning":"text-error"),children:[s.avgQuality.toFixed(1),"/10"]})}),e.jsx("td",{className:"px-5 py-3 text-right text-muted",children:j(s.avgCost)}),e.jsxs("td",{className:"px-5 py-3 text-right text-muted",children:[s.avgDuration.toFixed(1),"s"]}),e.jsx("td",{className:"px-5 py-3 text-right",children:!g&&t.status!=="completed"&&e.jsxs("button",{onClick:A=>{A.stopPropagation(),_(t.id,s.id)},className:i("inline-flex items-center gap-1 rounded-md px-2 py-1 text-xs font-medium","text-accent hover:bg-accent/10 transition-colors"),children:[e.jsx(R,{className:"h-3 w-3"}),"Deploy"]})})]},s.id)})})]})}),e.jsx("div",{className:"flex items-center justify-end gap-2 px-5 py-3 bg-background/30",children:e.jsxs("button",{onClick:s=>{s.stopPropagation(),k(t.id)},className:i("inline-flex items-center gap-1.5 rounded-md px-3 py-1.5 text-xs font-medium","border border-border text-muted hover:text-foreground hover:bg-border/40 transition-colors"),children:[e.jsx(M,{className:"h-3 w-3"}),"Reset Experiment"]})})]})]},t.id)})})]})}export{O as default};
