name: "Lead Enrichment"
description: "Enrich company data with industry classification, decision makers, and score leads for sales outreach priority. Provide company name or basic info as input."
default_model: sonnet
default_max_turns: 10
default_timeout: 300

input_schema:
  required: ["company_info"]
  properties:
    company_info:
      type: string
      description: "Company information to enrich - paste company name, website URL, or any known details. The agent will use curl for simple pages and its knowledge for enrichment."

steps:
  - id: "extract-data"
    prompt: |
      Analyze the provided company information and extract key data.
      If a URL is provided, try to fetch it using `curl -s -L URL | head -c 50000` to get additional context.
      Extract: company name, employees estimate, main product/service, contact information.
      Company info: {input.company_info}
    output_schema:
      type: object
      properties:
        company_name: { type: string }
        employees: { type: integer }
        product: { type: string }
        contact_email: { type: string }

  - id: "enrich"
    prompt: |
      Given this company data: {steps.extract-data.output}
      Using your built-in knowledge, research and enrich with:
      - Estimated annual revenue
      - Industry classification
      - Key decision makers (names and roles)
      - Recent news or funding rounds
    depends_on:
      - "extract-data"
    retry:
      max_attempts: 3
      backoff: exponential
      on_failure: abort

  - id: "score"
    prompt: |
      Based on this enriched lead data: {steps.enrich.output}
      Score this lead from 1-100 for B2B SaaS sales potential.
      Consider company size, industry fit, and growth signals.
      Assign a tier (A/B/C) and provide a one-sentence recommendation.
    depends_on:
      - "enrich"
    model: haiku
    output_schema:
      type: object
      properties:
        lead_score: { type: integer }
        tier: { type: string }
        recommendation: { type: string }

on_complete:
  storage_path: "leads/{run_id}/result.json"
